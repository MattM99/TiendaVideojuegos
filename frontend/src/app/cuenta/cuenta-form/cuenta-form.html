<h2>{{ isEdit ? 'Editar cuenta' : 'Nueva cuenta' }}</h2>

<div class="form-container">

  <!-- ================= PERSONA ASOCIADA ================= -->
  <h3>Persona asociada</h3>

  <label>Seleccione una persona existente</label>
  <select [ngModel]="cuenta().personaId" (ngModelChange)="updatePersonaId($event)">
    <option [ngValue]="undefined">-- Seleccione una persona --</option>
    @for (p of personas(); track p.id) {
      <option [ngValue]="p.id">
        {{ p.apellido }}, {{ p.nombre }} ({{ p.dni }})
      </option>
    }
  </select>

  <button type="button" (click)="crearNuevaPersona()">
    Crear persona nueva
  </button>


  <!-- ================= DATOS DE LA CUENTA ================= -->
  <h3>Datos de la cuenta</h3>

  <div class="form-group">
    <label>Usuario</label>
    <input type="text" [value]="cuenta().nombreUsuario" (input)="updateNombreUsuario($event.target.value)">
  </div>

  <div class="form-group password-group">
    <label>Contrase√±a</label>
    <div class="password-wrapper">
      <input [type]="showPassword ? 'text' : 'password'"
             [value]="cuenta().password"
             (input)="updatePassword($event.target.value)" />

      <button type="button" class="toggle-btn" (click)="togglePassword()">
        {{ showPassword ? 'Ocultar' : 'Mostrar' }}
      </button>
    </div>
  </div>

  <div class="form-group">
    <label>Rol</label>
    <select [ngModel]="cuenta().rol" (ngModelChange)="updateRol($event)">
      <option value="ADMIN">ADMINISTRADOR</option>
      <option value="EMPLEADO">EMPLEADO</option>
    </select>
  </div>

  <div class="form-group checkbox">
    <label>
      <input type="checkbox" [checked]="cuenta().alta" (change)="updateAlta($event.target.checked)">
      Activo
    </label>
  </div>

  <!-- ================= BOTONES ================= -->
  <div class="form-actions">
    <button class="save" (click)="save()">Guardar</button>
    <button class="cancel" (click)="router.navigate(['/cuentas'])">Cancelar</button>
  </div>

</div>




